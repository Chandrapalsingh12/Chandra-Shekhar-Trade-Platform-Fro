<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Terminal - Project Pulse</title>
    <link rel="stylesheet" href="{{ url_for('static', path='css/terminal.css') }}?v=2026020419">
</head>

<body>
    <div id="app">
        <script src="{{ url_for('static', path='js/terminal.js') }}?v=2026020402"></script>

        <!-- SCROLLING SIGNAL BAR (marquee) -->
        <header class="signal-bar">
            <div class="signal-label">
                <span class="signal-icon">ðŸ“¡</span>
                <span>SIGNALS</span>
            </div>
            <div class="signal-marquee">
                <div class="signal-track" id="signalTrack">
                    <!-- Signals will be inserted here by JS -->
                </div>
            </div>
        </header>

        <!-- MAIN CONTENT ROW -->
        <div class="content-row">

            <!-- LEFT SIDEBAR (WATCHLIST) -->
            <aside class="sidebar left-sidebar" id="leftSidebar">
                <div class="sidebar-header">
                    <span class="sidebar-title">WATCHLIST</span>
                    <div class="sidebar-controls">
                        <button class="pin-btn pinned" id="pinLeft" onclick="togglePin('left')"
                            title="Pin sidebar">ðŸ“Œ</button>
                        <button class="collapse-btn" id="collapseLeft" onclick="toggleSidebar('left')"
                            title="Collapse">â—€</button>
                    </div>
                </div>

                <div class="watchlist" id="watchlist">
                    <!-- TSLA -->
                    <div class="ticker-card active" data-symbol="TSLA" data-tv="NASDAQ:TSLA"
                        onclick="selectTicker(this)">
                        <div class="ticker-header">
                            <span class="notif-dot" id="notif-TSLA"></span>
                            <span class="ticker-symbol">TSLA</span>
                            <span class="ticker-price" id="price-TSLA">--</span>
                        </div>
                        <div class="arrows-row">
                            <span class="arrow-box" data-tf="1" onclick="onArrowClick(event,'TSLA','1')"><span
                                    class="arrow" id="arrow-TSLA-1">-</span><span class="tf-label">1</span></span>
                            <span class="arrow-box" data-tf="5" onclick="onArrowClick(event,'TSLA','5')"><span
                                    class="arrow" id="arrow-TSLA-5">-</span><span class="tf-label">5</span></span>
                            <span class="arrow-box" data-tf="15" onclick="onArrowClick(event,'TSLA','15')"><span
                                    class="arrow" id="arrow-TSLA-15">-</span><span class="tf-label">15</span></span>
                            <span class="arrow-box" data-tf="4h" onclick="onArrowClick(event,'TSLA','4h')"><span
                                    class="arrow" id="arrow-TSLA-4h">-</span><span class="tf-label">4h</span></span>
                            <span class="arrow-box" data-tf="8h" onclick="onArrowClick(event,'TSLA','8h')"><span
                                    class="arrow" id="arrow-TSLA-8h">-</span><span class="tf-label">8h</span></span>
                            <span class="arrow-box" data-tf="D" onclick="onArrowClick(event,'TSLA','D')"><span
                                    class="arrow" id="arrow-TSLA-D">-</span><span class="tf-label">D</span></span>
                            <span class="arrow-box" data-tf="W" onclick="onArrowClick(event,'TSLA','W')"><span
                                    class="arrow" id="arrow-TSLA-W">-</span><span class="tf-label">W</span></span>
                        </div>
                    </div>

                    <!-- NVDA -->
                    <div class="ticker-card" data-symbol="NVDA" data-tv="NASDAQ:NVDA" onclick="selectTicker(this)">
                        <div class="ticker-header">
                            <span class="notif-dot" id="notif-NVDA"></span>
                            <span class="ticker-symbol">NVDA</span>
                            <span class="ticker-price" id="price-NVDA">--</span>
                        </div>
                        <div class="arrows-row">
                            <span class="arrow-box" data-tf="1" onclick="onArrowClick(event,'NVDA','1')"><span
                                    class="arrow" id="arrow-NVDA-1">-</span><span class="tf-label">1</span></span>
                            <span class="arrow-box" data-tf="5" onclick="onArrowClick(event,'NVDA','5')"><span
                                    class="arrow" id="arrow-NVDA-5">-</span><span class="tf-label">5</span></span>
                            <span class="arrow-box" data-tf="15" onclick="onArrowClick(event,'NVDA','15')"><span
                                    class="arrow" id="arrow-NVDA-15">-</span><span class="tf-label">15</span></span>
                            <span class="arrow-box" data-tf="4h" onclick="onArrowClick(event,'NVDA','4h')"><span
                                    class="arrow" id="arrow-NVDA-4h">-</span><span class="tf-label">4h</span></span>
                            <span class="arrow-box" data-tf="8h" onclick="onArrowClick(event,'NVDA','8h')"><span
                                    class="arrow" id="arrow-NVDA-8h">-</span><span class="tf-label">8h</span></span>
                            <span class="arrow-box" data-tf="D" onclick="onArrowClick(event,'NVDA','D')"><span
                                    class="arrow" id="arrow-NVDA-D">-</span><span class="tf-label">D</span></span>
                            <span class="arrow-box" data-tf="W" onclick="onArrowClick(event,'NVDA','W')"><span
                                    class="arrow" id="arrow-NVDA-W">-</span><span class="tf-label">W</span></span>
                        </div>
                    </div>

                    <!-- AAPL -->
                    <div class="ticker-card" data-symbol="AAPL" data-tv="NASDAQ:AAPL" onclick="selectTicker(this)">
                        <div class="ticker-header">
                            <span class="notif-dot" id="notif-AAPL"></span>
                            <span class="ticker-symbol">AAPL</span>
                            <span class="ticker-price" id="price-AAPL">--</span>
                        </div>
                        <div class="arrows-row">
                            <span class="arrow-box" data-tf="1" onclick="onArrowClick(event,'AAPL','1')"><span
                                    class="arrow" id="arrow-AAPL-1">-</span><span class="tf-label">1</span></span>
                            <span class="arrow-box" data-tf="5" onclick="onArrowClick(event,'AAPL','5')"><span
                                    class="arrow" id="arrow-AAPL-5">-</span><span class="tf-label">5</span></span>
                            <span class="arrow-box" data-tf="15" onclick="onArrowClick(event,'AAPL','15')"><span
                                    class="arrow" id="arrow-AAPL-15">-</span><span class="tf-label">15</span></span>
                            <span class="arrow-box" data-tf="4h" onclick="onArrowClick(event,'AAPL','4h')"><span
                                    class="arrow" id="arrow-AAPL-4h">-</span><span class="tf-label">4h</span></span>
                            <span class="arrow-box" data-tf="8h" onclick="onArrowClick(event,'AAPL','8h')"><span
                                    class="arrow" id="arrow-AAPL-8h">-</span><span class="tf-label">8h</span></span>
                            <span class="arrow-box" data-tf="D" onclick="onArrowClick(event,'AAPL','D')"><span
                                    class="arrow" id="arrow-AAPL-D">-</span><span class="tf-label">D</span></span>
                            <span class="arrow-box" data-tf="W" onclick="onArrowClick(event,'AAPL','W')"><span
                                    class="arrow" id="arrow-AAPL-W">-</span><span class="tf-label">W</span></span>
                        </div>
                    </div>

                    <!-- SPY -->
                    <div class="ticker-card" data-symbol="SPY" data-tv="AMEX:SPY" onclick="selectTicker(this)">
                        <div class="ticker-header">
                            <span class="notif-dot" id="notif-SPY"></span>
                            <span class="ticker-symbol">SPY</span>
                            <span class="ticker-price" id="price-SPY">--</span>
                        </div>
                        <div class="arrows-row">
                            <span class="arrow-box" data-tf="1" onclick="onArrowClick(event,'SPY','1')"><span
                                    class="arrow" id="arrow-SPY-1">-</span><span class="tf-label">1</span></span>
                            <span class="arrow-box" data-tf="5" onclick="onArrowClick(event,'SPY','5')"><span
                                    class="arrow" id="arrow-SPY-5">-</span><span class="tf-label">5</span></span>
                            <span class="arrow-box" data-tf="15" onclick="onArrowClick(event,'SPY','15')"><span
                                    class="arrow" id="arrow-SPY-15">-</span><span class="tf-label">15</span></span>
                            <span class="arrow-box" data-tf="4h" onclick="onArrowClick(event,'SPY','4h')"><span
                                    class="arrow" id="arrow-SPY-4h">-</span><span class="tf-label">4h</span></span>
                            <span class="arrow-box" data-tf="8h" onclick="onArrowClick(event,'SPY','8h')"><span
                                    class="arrow" id="arrow-SPY-8h">-</span><span class="tf-label">8h</span></span>
                            <span class="arrow-box" data-tf="D" onclick="onArrowClick(event,'SPY','D')"><span
                                    class="arrow" id="arrow-SPY-D">-</span><span class="tf-label">D</span></span>
                            <span class="arrow-box" data-tf="W" onclick="onArrowClick(event,'SPY','W')"><span
                                    class="arrow" id="arrow-SPY-W">-</span><span class="tf-label">W</span></span>
                        </div>
                    </div>

                    <!-- Add Ticker -->
                    <div class="ticker-card add-btn" onclick="addTicker()">
                        <span class="plus">+</span>
                    </div>
                </div>

                <div class="account-box">
                    <div class="account-header">
                        <div class="label">PAPER</div>
                        <button class="reset-btn" onclick="resetAccount()" title="Reset Account">ðŸ”„</button>
                    </div>
                    <div class="balance" id="accountBalance">$10,000.00</div>
                </div>
            </aside>

            <!-- COLLAPSED LEFT INDICATOR -->
            <div class="collapsed-indicator left hidden" id="leftCollapsed" onclick="toggleSidebar('left')">
                <span>â–¶</span>
                <span class="collapsed-label">W</span>
            </div>

            <!-- CHART AREA -->
            <main class="chart-area">
                <div class="chart-header">
                    <span class="active-symbol" id="activeSymbol">TSLA</span>
                    <span class="live-price" id="livePrice">$--</span>
                </div>

                <div class="charts-container" id="chartsContainer">
                    <!-- Chart 1 -->
                    <div class="chart-pane" id="pane1" data-chart-index="0">
                        <div class="chart-selector-badge" onclick="selectChart(0)">1</div>
                        <button class="chart-btn chart-btn-maximize" onclick="toggleMaximize(0)"
                            title="Maximize">â›¶</button>

                        <!-- Interactive Overlays (HIDDEN - TradingView manages lines) -->
                        <div class="drag-layer" id="dragLayer1" style="display: none;">
                            <div class="drag-line tp" id="lineTP1">
                                <div class="drag-handle tp" id="handleTP1"><span class="pill">TP</span><span
                                        id="labelTP1">$0.00</span></div>
                            </div>
                            <div class="drag-line entry" id="lineEntry1">
                                <div class="drag-handle entry" id="handleEntry1"><span class="pill">ENTRY</span><span
                                        id="labelEntry1">$0.00</span></div>
                            </div>
                            <div class="drag-line stop" id="lineStop1">
                                <div class="drag-handle stop" id="handleStop1"><span class="pill">SL</span><span
                                        id="labelStop1">$0.00</span></div>
                            </div>
                        </div>

                        <!-- Position State Overlay -->
                        <div class="position-overlay" id="positionOverlay">
                            <div class="overlay-header">
                                <span class="overlay-title">UTBot + Position State</span>
                                <span class="overlay-badge badge-flat" id="ovPosBadge">FLAT</span>
                            </div>
                            <div class="overlay-row"><span class="overlay-label">Entry</span><span class="overlay-value"
                                    id="ovEntry">â€”</span></div>
                            <div class="overlay-row"><span class="overlay-label">Stop</span><span
                                    class="overlay-value neg" id="ovStop">â€”</span></div>
                            <div class="overlay-row"><span class="overlay-label">Target</span><span
                                    class="overlay-value pos" id="ovTarget">â€”</span></div>
                            <div class="overlay-row"><span class="overlay-label">Position</span><span
                                    class="overlay-value" id="ovPos">â€”</span></div>
                            <div class="overlay-row"><span class="overlay-label">Unrealized P&L</span><span
                                    class="overlay-value" id="ovPnl">$0.00</span></div>
                        </div>

                        <div class="chart-widget" id="chart1"></div>
                        <div class="chart-mode-badge"></div>
                    </div>

                    <!-- Resize Handle 1 -->
                    <div class="resize-handle" id="resize1"></div>

                    <!-- Chart 2 -->
                    <div class="chart-pane" id="pane2" data-chart-index="1">
                        <div class="chart-selector-badge" onclick="selectChart(1)">2</div>
                        <button class="chart-btn chart-btn-maximize" onclick="toggleMaximize(1)"
                            title="Maximize">â›¶</button>

                        <!-- Interactive Overlays (HIDDEN - TradingView manages lines) -->
                        <div class="drag-layer" id="dragLayer2" style="display: none;">
                            <div class="drag-line tp" id="lineTP2">
                                <div class="drag-handle tp" id="handleTP2"><span class="pill">TP</span><span
                                        id="labelTP2">$0.00</span></div>
                            </div>
                            <div class="drag-line entry" id="lineEntry2">
                                <div class="drag-handle entry" id="handleEntry2"><span class="pill">ENTRY</span><span
                                        id="labelEntry2">$0.00</span></div>
                            </div>
                            <div class="drag-line stop" id="lineStop2">
                                <div class="drag-handle stop" id="handleStop2"><span class="pill">SL</span><span
                                        id="labelStop2">$0.00</span></div>
                            </div>
                        </div>

                        <div class="chart-widget" id="chart2"></div>
                        <div class="chart-mode-badge"></div>
                    </div>

                    <!-- Resize Handle 2 -->
                    <div class="resize-handle" id="resize2"></div>

                    <!-- Chart 3 -->
                    <div class="chart-pane" id="pane3" data-chart-index="2">
                        <div class="chart-selector-badge" onclick="selectChart(2)">3</div>
                        <button class="chart-btn chart-btn-maximize" onclick="toggleMaximize(2)"
                            title="Maximize">â›¶</button>

                        <!-- Interactive Overlays (HIDDEN - TradingView manages lines) -->
                        <div class="drag-layer" id="dragLayer3" style="display: none;">
                            <div class="drag-line tp" id="lineTP3">
                                <div class="drag-handle tp" id="handleTP3"><span class="pill">TP</span><span
                                        id="labelTP3">$0.00</span></div>
                            </div>
                            <div class="drag-line entry" id="lineEntry3">
                                <div class="drag-handle entry" id="handleEntry3"><span class="pill">ENTRY</span><span
                                        id="labelEntry3">$0.00</span></div>
                            </div>
                            <div class="drag-line stop" id="lineStop3">
                                <div class="drag-handle stop" id="handleStop3"><span class="pill">SL</span><span
                                        id="labelStop3">$0.00</span></div>
                            </div>
                        </div>

                        <div class="chart-widget" id="chart3"></div>
                        <div class="chart-mode-badge"></div>
                    </div>
                </div>
            </main>

            <!-- COLLAPSED RIGHT INDICATOR -->
            <div class="collapsed-indicator right hidden" id="rightCollapsed" onclick="toggleSidebar('right')">
                <span>â—€</span>
                <span class="collapsed-label">E</span>
            </div>

            <!-- RIGHT SIDEBAR (EXECUTION) -->
            <aside class="sidebar right-sidebar" id="rightSidebar">
                <div class="sidebar-header">
                    <span class="sidebar-title">EXECUTE</span>
                    <div class="sidebar-controls">
                        <button class="pin-btn" id="pinRight" onclick="togglePin('right')"
                            title="Pin sidebar">ðŸ“Œ</button>
                        <button class="collapse-btn" id="collapseRight" onclick="toggleSidebar('right')"
                            title="Collapse">â–¶</button>
                    </div>
                </div>

                <div class="exec-content">
                    <!-- Position State Badge -->
                    <div class="position-state">
                        <span class="state-label">Position</span>
                        <span class="state-badge badge-flat" id="posBadge">FLAT</span>
                    </div>

                    <!-- Side -->
                    <div class="order-group">
                        <label class="order-label">Side <span class="hint">auto</span></label>
                        <select class="order-select" id="side" onchange="calcSize()">
                            <option value="BUY" selected>BUY (Long)</option>
                            <option value="SELL">SELL (Short)</option>
                        </select>
                    </div>

                    <!-- Quantity -->
                    <div class="order-group">
                        <label class="order-label">Quantity</label>
                        <input type="number" class="order-input" id="quantity" value="100" oninput="calcSize()">
                    </div>

                    <!-- Entry Price -->
                    <div class="order-group">
                        <label class="order-label">Entry Price <span class="hint">drag line</span></label>
                        <input type="number" class="order-input" id="entryPrice" placeholder="0.00" step="0.01"
                            oninput="calcSize()">
                    </div>

                    <!-- Stop Loss -->
                    <div class="order-group">
                        <label class="order-label">Stop Loss <span class="hint">drag</span></label>
                        <input type="number" class="order-input" id="stopLoss" placeholder="0.00" step="0.01"
                            oninput="calcSize()">
                    </div>

                    <!-- Take Profit -->
                    <div class="order-group">
                        <label class="order-label">Take Profit <span class="hint">drag</span></label>
                        <input type="number" class="order-input" id="takeProfit" placeholder="0.00" step="0.01"
                            oninput="calcSize()">
                    </div>

                    <!-- Risk Display Box -->
                    <div class="risk-display">
                        <div class="risk-row">
                            <span class="risk-label">Risk/Share</span>
                            <span class="risk-value neg" id="riskPerShare">$0.00</span>
                        </div>
                        <div class="risk-row">
                            <span class="risk-label">Reward/Share</span>
                            <span class="risk-value pos" id="rewardPerShare">$0.00</span>
                        </div>
                        <div class="risk-row">
                            <span class="risk-label">R:R</span>
                            <span class="risk-value" id="rrRatio">â€”</span>
                        </div>
                        <div class="risk-row">
                            <span class="risk-label">Unrealized P&L</span>
                            <span class="risk-value" id="pnlNow">$0.00</span>
                        </div>
                    </div>

                    <!-- Execute Buttons -->
                    <div class="action-btns">
                        <button class="btn-buy" id="btnBuy" onclick="executeTrade('BUY')" disabled>BUY</button>
                        <button class="btn-sell" id="btnSell" onclick="executeTrade('SELL')" disabled>SELL</button>
                    </div>

                    <!-- Position Management -->
                    <div class="position-btns">
                        <button class="btn-close" id="btnClose" onclick="closePosition()">Close Position</button>
                        <button class="btn-be" onclick="moveStopToBreakeven()">Move SL â†’ BE</button>
                    </div>

                    <!-- STAGED / ARM / KILL -->
                    <div class="arm-controls">
                        <button class="btn-staged" id="btnStaged" onclick="toggleStaged()">âšª STAGED</button>
                        <button class="btn-arm" id="btnArm" onclick="toggleArm()" disabled>ðŸŸ¢ ARM</button>
                    </div>
                    <button class="btn-kill" onclick="killSwitch()">ðŸ›‘ KILL</button>
                </div>
            </aside>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toasts"></div>

    <!-- TradingView Widget -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

    <!-- TradingView Lightweight Charts -->
    <script src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"></script>

    <!-- App Script -->
    <script src="{{ url_for('static', path='js/terminal.js') }}?v=2026020415"></script>
</body>

</html>